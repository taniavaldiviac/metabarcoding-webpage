---
title: "Control de calidad QAQC"
#subtitle: "24–28 de noviembre de 2025<br>Instituto de Ciencias del Mar y Limnología (UNAM)"
format:
  html:
    toc-depth: 3
    code-fold: true
    code-tools: true
    #theme: cosmo
    highlight-style: github
    embed-resources: true
execute:
  echo: false
  warning: false
---

## Objetivo

En esta clase aprenderemos a realizar control de calidad (QA/QC) en archivos FASTQ usando herramientas bioinformáticas.

## Pasos principales

1.  **Verificación de integridad de archivos**
2.  **Conteo de lecturas**
3.  **Análisis de calidad con FastQC**
4.  **Filtrado y recorte de lecturas**
5.  **Revisión de resultados**

## 1. Verificación de integridad

Es una **verificación de integridad** por *checksum*:

-   Para cada archivo .fastq, generas un hash (una “huella” única de sus bytes).

-   Guardas esas huellas en un manifiesto (checksums.sha256).

-   Luego shasum -a 256 -c checksums.sha256 recalcula la huella de cada archivo presente y la compara con la esperada.

``` bash
find raw_fastqs -type f -name '*.fastq*' -print0 \
  | sort -z \
  | xargs -0 shasum -a 256 > checksums.sha256
```

Para verificar:

``` bash
shasum -a 256 -c checksums.sha256
```

## 2. Conteo de lecturas

Cada lectura ocupa 4 líneas en un archivo FASTQ.
Para contar lecturas:

``` bash
for f in raw_fastqs/*.fastq; do echo -n "$(basename "$f")   "; expr $(wc -l < "$f") / 4; done > conteo_lecturas.tsv
```

## 3. Análisis de calidad con FastQC

Instala FastQC y ejecuta:

``` bash
mkdir fastqc_reports
fastqc raw_fastqs/*.fastq -o fastqc_reports/
```

## 4. Filtrado y recorte de lecturas

Puedes usar herramientas como Cutadapt o Trimmomatic.
Ejemplo con Cutadapt:

``` bash
cutadapt -q 20 -o output_trimmed.fastq input.fastq
```

## 5. Revisión de resultados

Vuelve a correr FastQC sobre los archivos filtrados y compara los reportes.

## Ejemplo en R: Leer el conteo de lecturas

``` r
conteo <- read.table("conteo_lecturas.tsv", header = FALSE, sep = "\t")
colnames(conteo) <- c("Archivo", "Lecturas")
print(conteo)
```

## Conclusiones

El control de calidad es esencial para asegurar la confiabilidad de los datos antes de cualquier análisis bioinformático.
